# This workflow enables developers to call PR-Agents `/[actions]` in PR's comments and upon PR creation.
# Learn more at https://www.codium.ai/pr-agent/
# This is v0.2 of this workflow file

name: PR-Agent

on:
# pull_request:
# issue_comment:
  workflow_dispatch:
    inputs:
      pr_url:
        description: 'PR URL to review (e.g., https://github.com/owner/repo/pull/123)'
        required: true
        type: string

permissions:
  issues: write
  pull-requests: write
  contents: read

jobs:
  pr_agent_job:
    runs-on: ubuntu-latest
    name: Run pr agent on every pull request
    steps:
      - name: PR Agent action step
        id: pragent
        uses: owen26/pr-agent@main
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          ANTHROPIC.KEY: ${{ secrets.ANTHROPIC_KEY }}
          ANTHROPIC.API_BASE: ${{ secrets.ANTHROPIC_API_BASE }}
          config.model: ${{ vars.PR_AGENT_MODEL || 'anthropic/MiniMax-M2.1' }}
          GITHUB_ACTION_CONFIG.AUTO_REVIEW: true
          GITHUB_ACTION_CONFIG.AUTO_DESCRIBE: true
          GITHUB_ACTION_CONFIG.AUTO_IMPROVE: true
